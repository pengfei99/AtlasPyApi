from atlas_client.client import Atlas
from atlas_client.entity_search.EntityFinder import EntityFinder

atlas_prod_hostname = "https://atlas.lab.sspcloud.fr"
atlas_prod_port = 443
oidc_token = "eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJhUHNCSzhYRC1od1gtMWJFbjdZZDRLS0tWS0hYRy03RHg3STZDaVZZWUtRIn0.eyJleHAiOjE2MDM0OTkzNTcsImlhdCI6MTYwMzQ1NjE1NywiYXV0aF90aW1lIjoxNjAzNDU2MTU3LCJqdGkiOiJkNDBlNTEzZC03MTIyLTRjMTUtOTE3OS05ZTU1NTNkZjJmMjgiLCJpc3MiOiJodHRwczovL2F1dGgubGFiLnNzcGNsb3VkLmZyL2F1dGgvcmVhbG1zL3NzcGNsb3VkIiwiYXVkIjpbIm9ueXhpYSIsImFjY291bnQiXSwic3ViIjoiNDczNDkxMjgtNGE0Yy00MjI2LWE1YjEtNjgwODAxYWY1YTJiIiwidHlwIjoiQmVhcmVyIiwiYXpwIjoib255eGlhIiwibm9uY2UiOiJhYzZiYWFkZC01NjlhLTQ0Y2ItOGFlMC02YzU3ZmM0ZDlmYjEiLCJzZXNzaW9uX3N0YXRlIjoiYzc5ODgxZjEtMWQwOC00MDUyLWFlZmYtYjEyMmRjZDg4MDNmIiwiYWNyIjoiMSIsImFsbG93ZWQtb3JpZ2lucyI6WyIqIl0sInJlYWxtX2FjY2VzcyI6eyJyb2xlcyI6WyJBdGxhc19yb2xlX2FkbWluIl19LCJyZXNvdXJjZV9hY2Nlc3MiOnsiYWNjb3VudCI6eyJyb2xlcyI6WyJtYW5hZ2UtYWNjb3VudCIsIm1hbmFnZS1hY2NvdW50LWxpbmtzIiwidmlldy1wcm9maWxlIl19fSwic2NvcGUiOiJvcGVuaWQgcHJvZmlsZSBlbWFpbCIsImVtYWlsX3ZlcmlmaWVkIjp0cnVlLCJuYW1lIjoiUGVuZ2ZlaSBMaXUiLCJwcmVmZXJyZWRfdXNlcm5hbWUiOiJwZW5nZmVpIiwiZ2l2ZW5fbmFtZSI6IlBlbmdmZWkiLCJmYW1pbHlfbmFtZSI6IkxpdSIsImVtYWlsIjoibGl1LnBlbmdmZWlAaG90bWFpbC5mciJ9.PZmQWv5TuFaWq2Yg374jJqzGj45cDkIkL1JFg_pBkYdKT9ABqbDwnoJt9Wp3wvLyghCHRswAdUJQY7CMuJfYvl0cYJGvrD8bQGolTcR2VD67VDY7M0tM5XbFhLF5xNFQzj93tUx30SgNOxe95A3X0PiVg7yNxwgtW_QpSdESsfLbtD-VZ91LEklpOZpFIZ4vIJ6MzhTHavAS4eusVc07QvaKiK4VuEfeMnyjD0SPVdvlUsR1I1bvlY7DdwPZdHRPC7u9aQakHDL8dfjw3pIt6hAfE4XReH3_KC2Sja8ydLck8zQkAiGd6ZDzMEcW6SocbI3lObLQuT18CYWxUX3j6w"

atlas_hostname = "localhost"
atlas_port = 21000
atlas_login = "admin"
atlas_pwd = "admin"

atlas_prod_client = Atlas(atlas_prod_hostname, atlas_prod_port, oidc_token=oidc_token)
# atlas_client = Atlas(atlas_hostname, atlas_port, atlas_login, atlas_pwd)

finder = EntityFinder(atlas_prod_client)
# finder.search_by_attribute("aws_s3_bucket", "owner", "foobar")

search_result = finder.search_full_text("aws_s3_bucket", "insee")

print(search_result)
EntityFinder.show_search_results(search_result)
entity_number = EntityFinder.get_entity_number(search_result)
print("Find " + str(entity_number) + " result in total")

guid_list, name_list = EntityFinder.get_result_entity_guid_list(search_result)

for guid in guid_list:
    print("result entity guid: " + guid)

for name in name_list:
    print("result name: " + name)
