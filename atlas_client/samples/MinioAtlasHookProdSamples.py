from atlas_client.client import Atlas
from atlas_client.minio.MinioAtlasHook import MinioAtlasHook
from atlas_client.minio.MinioClient import MinioClient

minio_end_point = 'minio.lab.sspcloud.fr'
minio_access_key = '1VUQ11H0673SIP19AN6A'
minio_secret_key = 'Vg0tOVDjLpBlZPC+vI0f8AY0D0S0qThTijbntsXp'
minio_token = 'eyJhbGciOiJIUzUxMiIsInR5cCI6IkpXVCJ9.eyJhY2Nlc3NLZXkiOiIxVlVRMTFIMDY3M1NJUDE5QU42QSIsImFjciI6IjAiLCJhbGxvd2VkLW9yaWdpbnMiOlsiKiJdLCJhdWQiOlsib255eGlhIiwiYWNjb3VudCJdLCJhdXRoX3RpbWUiOjE2MDMxNzg1MTcsImF6cCI6Im9ueXhpYSIsImVtYWlsIjoibGl1LnBlbmdmZWlAaG90bWFpbC5mciIsImVtYWlsX3ZlcmlmaWVkIjp0cnVlLCJleHAiOiIxNjAzMjIxNzE3IiwiZmFtaWx5X25hbWUiOiJMaXUiLCJnaXZlbl9uYW1lIjoiUGVuZ2ZlaSIsImlhdCI6MTYwMzE4MTc5MiwiaXNzIjoiaHR0cHM6Ly9hdXRoLmxhYi5zc3BjbG91ZC5mci9hdXRoL3JlYWxtcy9zc3BjbG91ZCIsImp0aSI6ImE0NTgwNTgwLWQ5ZTktNDU2Mi1hZTdhLTExNzgxOWUxOWE3YiIsIm5hbWUiOiJQZW5nZmVpIExpdSIsIm5vbmNlIjoiZmU1ODZjYWQtYzhmNy00NGYxLWE1N2UtZDE0ZjNkZmZkZjk4IiwicG9saWN5IjoiIiwicHJlZmVycmVkX3VzZXJuYW1lIjoicGVuZ2ZlaSIsInJlYWxtX2FjY2VzcyI6eyJyb2xlcyI6WyJBdGxhc19yb2xlX2FkbWluIl19LCJyZXNvdXJjZV9hY2Nlc3MiOnsiYWNjb3VudCI6eyJyb2xlcyI6WyJtYW5hZ2UtYWNjb3VudCIsIm1hbmFnZS1hY2NvdW50LWxpbmtzIiwidmlldy1wcm9maWxlIl19fSwic2NvcGUiOiJvcGVuaWQgcHJvZmlsZSBlbWFpbCIsInNlc3Npb25fc3RhdGUiOiI2N2IzZDg4ZS05OGJlLTQyZDAtOTFiYy0wOTNkMWUyYTA1OTIiLCJzdWIiOiI0NzM0OTEyOC00YTRjLTQyMjYtYTViMS02ODA4MDFhZjVhMmIiLCJ0eXAiOiJCZWFyZXIifQ.Ss4L_KBfvhSEYjEneQiWo32TVAurb-GkqaqCfQ4FPRM_J-Of66HT2kcRAKDxZdcyqsJV5mUEu4NybHBuugAQ6w'

atlas_prod_hostname = "https://atlas.lab.sspcloud.fr"
atlas_prod_port = 443
oidc_token = "eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJhUHNCSzhYRC1od1gtMWJFbjdZZDRLS0tWS0hYRy03RHg3STZDaVZZWUtRIn0.eyJleHAiOjE2MDMyMjE3MTcsImlhdCI6MTYwMzE4MjI4NywiYXV0aF90aW1lIjoxNjAzMTc4NTE3LCJqdGkiOiJhYWY2NDNjZC0wZmU1LTQ5ZWUtYjlhYi0wMzZmZjUyMWNjZWEiLCJpc3MiOiJodHRwczovL2F1dGgubGFiLnNzcGNsb3VkLmZyL2F1dGgvcmVhbG1zL3NzcGNsb3VkIiwiYXVkIjpbIm9ueXhpYSIsImFjY291bnQiXSwic3ViIjoiNDczNDkxMjgtNGE0Yy00MjI2LWE1YjEtNjgwODAxYWY1YTJiIiwidHlwIjoiQmVhcmVyIiwiYXpwIjoib255eGlhIiwibm9uY2UiOiI2YmU3NmIwMy05NGIwLTQwZjYtODNlNS0wNjU5NWY5OWE2MjciLCJzZXNzaW9uX3N0YXRlIjoiNjdiM2Q4OGUtOThiZS00MmQwLTkxYmMtMDkzZDFlMmEwNTkyIiwiYWNyIjoiMCIsImFsbG93ZWQtb3JpZ2lucyI6WyIqIl0sInJlYWxtX2FjY2VzcyI6eyJyb2xlcyI6WyJBdGxhc19yb2xlX2FkbWluIl19LCJyZXNvdXJjZV9hY2Nlc3MiOnsiYWNjb3VudCI6eyJyb2xlcyI6WyJtYW5hZ2UtYWNjb3VudCIsIm1hbmFnZS1hY2NvdW50LWxpbmtzIiwidmlldy1wcm9maWxlIl19fSwic2NvcGUiOiJvcGVuaWQgcHJvZmlsZSBlbWFpbCIsImVtYWlsX3ZlcmlmaWVkIjp0cnVlLCJuYW1lIjoiUGVuZ2ZlaSBMaXUiLCJwcmVmZXJyZWRfdXNlcm5hbWUiOiJwZW5nZmVpIiwiZ2l2ZW5fbmFtZSI6IlBlbmdmZWkiLCJmYW1pbHlfbmFtZSI6IkxpdSIsImVtYWlsIjoibGl1LnBlbmdmZWlAaG90bWFpbC5mciJ9.lLNeJ8vyi8AD6evIS2UnbH2UdkVmI7rVtX5Ah-38_iNL2-pQ6-AeynU8jrHlxxpV_I0SEAC8GkADkuGlQFMfR5g8NMFIC9GSD3rbDfspPxM7f-GBUHY0dMgeqJxtRTNePVnEsPox4bP5xttIIAjCrfEjwDHUbCuldcm82HAsbDJwGu5GCbQKf6CNiyZEXWw-u-ncZbHUxO3eiZ4H0RNHy93WXWEpPZ6Il96f-Pn4Muef5yPraoDliarCoSQPylTK61lKrQyzdOLUxb23lfJEgQzb6bUJXtUiu8mQZpM4Jipl2PUgIKqJ7rAuRgACvMRDskQgXUewA3PUkh-YpW2Cyg"

minio_client = MinioClient(minio_end_point, minio_access_key, minio_secret_key, minio_token)
atlas_client = Atlas(atlas_prod_hostname, atlas_prod_port, oidc_token=oidc_token)
minio_hook = MinioAtlasHook(minio_client, atlas_client)

path = "pengfei"


meta_data = minio_client.get_path_meta_data(path)
# print(meta_data)

path_class = minio_client.get_type_from_path(path)
print(path_class)


path_type = minio_client.get_type_from_path(path)
print(path_type)

minio_hook.create_atlas_bucket(meta_data,"added by minio hook")

